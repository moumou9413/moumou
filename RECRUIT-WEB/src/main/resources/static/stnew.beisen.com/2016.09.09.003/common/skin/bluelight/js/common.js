(function($){$.extend($.fn,{replaceChinesePlace:function(value){var v=$.trim(value);return v.replace(/(^　*)|(　*$)/g,"")},validate:function(options){if(!this.length){options&&options.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing");return}var validator=$.data(this[0],"validator");if(validator)return validator;validator=new $.validator(options,this[0]);$.data(this[0],"validator",validator);if(validator.settings.onsubmit){this.find("input, button").filter(".cancel").click(function(){validator.cancelSubmit=true});validator.settings.submitHandler&&this.find("input, button").filter(":submit").click(function(){validator.submitButton=this});this.submit(function(event){validator.settings.debug&&event.preventDefault();function handle(){if(validator.settings.submitHandler){if(validator.submitButton)var hidden=$("<input type='hidden'/>").attr("name",validator.submitButton.name).val(validator.submitButton.value).appendTo(validator.currentForm);validator.settings.submitHandler.call(validator,validator.currentForm);validator.submitButton&&hidden.remove();return false}return true}if(validator.cancelSubmit){validator.cancelSubmit=false;return handle()}if(validator.form()){if(validator.pendingRequest){validator.formSubmitted=true;return false}return handle()}else{validator.focusInvalid();return false}})}return validator},valid:function(){if($(this[0]).is("form"))return this.validate().form();else{var valid=true,validator=$(this[0].form).validate();this.each(function(){valid&=validator.element(this)});return valid}},removeAttrs:function(attributes){var result={},$element=this;$.each(attributes.split(/\s/),function(index,value){result[value]=$element.attr(value);$element.removeAttr(value)});return result},rules:function(command,argument){var element=this[0];if(command){var settings=$.data(element.form,"validator").settings,staticRules=settings.rules,existingRules=$.validator.staticRules(element);switch(command){case"add":$.extend(existingRules,$.validator.normalizeRule(argument));staticRules[element.name]=existingRules;if(argument.messages)settings.messages[element.name]=$.extend(settings.messages[element.name],argument.messages);break;case"remove":if(!argument){delete staticRules[element.name];return existingRules}var filtered={};$.each(argument.split(/\s/),function(index,method){filtered[method]=existingRules[method];delete existingRules[method]});return filtered}}var data=$.validator.normalizeRules($.extend({},$.validator.metadataRules(element),$.validator.classRules(element),$.validator.attributeRules(element),$.validator.staticRules(element)),element);if(data.required){var param=data.required;delete data.required;data=$.extend({required:param},data)}return data}});$.extend($.expr[":"],{blank:function(a){return!$.trim(""+a.value)},filled:function(a){return!!$.trim(""+a.value)},unchecked:function(a){return!a.checked}});$.validator=function(options,form){this.settings=$.extend(true,{},$.validator.defaults,options);this.currentForm=form;this.init()};$.validator.format=function(source,params){if(arguments.length==1)return function(){var args=$.makeArray(arguments);args.unshift(source);return $.validator.format.apply(this,args)};if(arguments.length>2&&params.constructor!=Array)params=$.makeArray(arguments).slice(1);if(params.constructor!=Array)params=[params];$.each(params,function(i,n){source=source.replace(new RegExp("\\{"+i+"\\}","g"),n)});return source};$.extend($.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"new_pop_error",validClass:"valid",errorElement:"span",focusInvalid:true,errorContainer:$([]),errorLabelContainer:$([]),noticeClass:"new_pop_notice",noticeElement:"span",focusNotice:false,noticeContainer:$([]),onsubmit:true,ignore:[],ignoreTitle:false,onfocusin:function(element){this.lastActive=element;if(this.settings.focusCleanup&&!this.blockFocusCleanup){this.settings.unhighlight&&this.settings.unhighlight.call(this,element,this.settings.errorClass,this.settings.validClass);this.addWrapper(this.errorsFor(element)).hide()}},onfocusout:function(element){!this.checkable(element)&&(element.name in this.submitted||!this.optional(element))&&this.element(element)},onkeyup:function(element){(element.name in this.submitted||element==this.lastElement)&&this.element(element)},onclick:function(element){if(element.name in this.submitted)this.element(element);else element.parentNode.name in this.submitted&&this.element(element.parentNode)},highlight:function(element,errorClass,validClass){$(element).siblings(this.settings.noticeElement+"."+this.settings.noticeClass).remove();$(element).siblings("span.chkok").remove();if(element.type==="radio")this.findByName(element.name).addClass(errorClass).removeClass(validClass);else $(element).addClass(errorClass).removeClass(validClass)},unhighlight:function(element,errorClass,validClass){$(element).siblings(this.settings.noticeElement+"."+this.settings.noticeClass).remove();$(element).siblings("span.chkok").remove();$(element).parent().append("<span class='chkok'></span>");if(element.type==="radio")this.findByName(element.name).removeClass(errorClass).addClass(validClass);else $(element).removeClass(errorClass).addClass(validClass)}},setDefaults:function(settings){$.extend($.validator.defaults,settings)},messages:{required:"必填",remote:"请修正该字段",email:"邮箱格式有误",specialword:'名称不能包含下列任何字符：< > : * ? " / \\ |',url:"网址格式有误",date:"日期格式:2008.10.10",dateISO:"请输入合法的日期 (ISO)",number:"您只能输入数字",digits:"您只能输入整数",creditcard:"请输入合法的信用卡号",equalTo:"验证项错误",accept:"文件后缀错误",specialchar:"不能输入特殊字符",RecSpecialChar:"不能输入特殊字符' < >",maxlength:$.validator.format("请输入一个长度最多是 {0} 的字符串"),minlength:$.validator.format("请输入一个长度最少是 {0} 的字符串"),rangelength:$.validator.format("请输入一个长度介于 {0} 和 {1} 之间的字符串"),range:$.validator.format("请输入一个介于 {0} 和 {1} 之间的值"),max:$.validator.format("请输入一个最大为 {0} 的值"),min:$.validator.format("请输入一个最小为 {0} 的值")},autoCreateRanges:false,prototype:{init:function(){this.labelContainer=$(this.settings.errorLabelContainer);this.errorContext=this.labelContainer.length&&this.labelContainer||$(this.currentForm);this.containers=$(this.settings.errorContainer).add(this.settings.errorLabelContainer);this.submitted={};this.valueCache={};this.pendingRequest=0;this.pending={};this.invalid={};this.reset();var groups=this.groups={};$.each(this.settings.groups,function(key,value){$.each(value.split(/\s/),function(index,name){groups[name]=key})});var rules=this.settings.rules;$.each(rules,function(key,value){rules[key]=$.validator.normalizeRule(value)});function delegate(event){var validator=$.data(this[0].form,"validator"),eventType="on"+event.type.replace(/^validate/,"");validator.settings[eventType]&&validator.settings[eventType].call(validator,this[0])}$(this.currentForm).validateDelegate(":text, :password, :file, select, textarea","focusin focusout keyup",delegate).validateDelegate(":radio, :checkbox, select, option","click",delegate);this.settings.invalidHandler&&$(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler);this.settings.focusNotice&&this.showNotice()},showNotice:function(){var that=this,flag=false;$(this.currentForm).validateDelegate(":text, :password, textarea","focusin focusout",function(event){eventType="on"+event.type.replace(/^validate/,"");if(eventType=="onfocusin"){if($(this).val()==""&&$(this).attr("notice")!==undefined&&!flag){var notice=$("<"+that.settings.noticeElement+"/>").addClass(that.settings.noticeClass).css("display","inline-block").html($(this).attr("notice"));$(this).siblings("span.chkok").remove();$(this).siblings(that.settings.errorElement+"."+that.settings.errorClass).remove();notice.appendTo($(this).parent());flag=true;return}}else if(eventType=="onfocusout"){$(this).siblings(that.settings.noticeElement+"."+that.settings.noticeClass).remove();flag=false;return}})},form:function(){this.checkForm();$.extend(this.submitted,this.errorMap);this.invalid=$.extend({},this.errorMap);!this.valid()&&$(this.currentForm).triggerHandler("invalid-form",[this]);this.showErrors();return this.valid()},checkForm:function(){this.prepareForm();for(var i=0,elements=this.currentElements=this.elements();elements[i];i++)this.check(elements[i]);return this.valid()},element:function(element){element=this.clean(element);this.lastElement=element;this.prepareElement(element);this.currentElements=$(element);var result=this.check(element);if(result)delete this.invalid[element.name];else this.invalid[element.name]=true;if(!this.numberOfInvalids())this.toHide=this.toHide.add(this.containers);this.showErrors();return result},showErrors:function(errors){if(errors){$.extend(this.errorMap,errors);this.errorList=[];for(var name in errors)this.errorList.push({message:errors[name],element:this.findByName(name)[0]});this.successList=$.grep(this.successList,function(element){return!(element.name in errors)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){$.fn.resetForm&&$(this.currentForm).resetForm();this.submitted={};this.prepareForm();this.hideErrors();this.elements().removeClass(this.settings.errorClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(obj){var count=0;for(var i in obj)count++;return count},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return this.size()==0},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{$(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(e){}},findLastActive:function(){var lastActive=this.lastActive;return lastActive&&$.grep(this.errorList,function(n){return n.element.name==lastActive.name}).length==1&&lastActive},elements:function(){var validator=this,rulesCache={};return $(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){!this.name&&validator.settings.debug&&window.console&&console.error("%o has no name assigned",this);if(this.name in rulesCache||!validator.objectLength($(this).rules()))return false;rulesCache[this.name]=true;return true})},clean:function(selector){return $(selector)[0]},errors:function(){return $(this.settings.errorElement+"."+this.settings.errorClass,this.errorContext)},reset:function(){this.successList=[];this.errorList=[];this.errorMap={};this.toShow=$([]);this.toHide=$([]);this.currentElements=$([])},prepareForm:function(){this.reset();this.toHide=this.errors().add(this.containers)},prepareElement:function(element){this.reset();this.toHide=this.errorsFor(element)},check:function(element){element=this.clean(element);if(this.checkable(element))element=this.findByName(element.name).not(this.settings.ignore)[0];var rules=$(element).rules(),dependencyMismatch=false;for(var method in rules){var rule={method:method,parameters:rules[method]};try{var result=$.validator.methods[method].call(this,element.value.replace(/\r/g,""),element,rule.parameters);if(result=="dependency-mismatch"){dependencyMismatch=true;continue}dependencyMismatch=false;if(result=="pending"){this.toHide=this.toHide.not(this.errorsFor(element));return}if(!result){this.formatAndAdd(element,rule);return false}}catch(e){this.settings.debug&&window.console&&console.log("exception occured when checking element "+element.id+", check the '"+rule.method+"' method",e);throw e;}}if(dependencyMismatch)return;this.objectLength(rules)&&this.successList.push(element);return true},customMetaMessage:function(element,method){if(!$.metadata)return;var meta=this.settings.meta?$(element).metadata()[this.settings.meta]:$(element).metadata();return meta&&meta.messages&&meta.messages[method]},customMessage:function(name,method){var m=this.settings.messages[name];return m&&(m.constructor==String?m:m[method])},findDefined:function(){for(var i=0;i<arguments.length;i++)if(arguments[i]!==undefined)return arguments[i];return undefined},defaultMessage:function(element,method){return this.findDefined(this.customMessage(element.name,method),this.customMetaMessage(element,method),!this.settings.ignoreTitle&&element.title||undefined,$.validator.messages[method],"<strong>Warning: No message defined for "+element.name+"</strong>")},formatAndAdd:function(element,rule){var message=this.defaultMessage(element,rule.method),theregex=/\$?\{(\d+)\}/g;if(typeof message=="function")message=message.call(this,rule.parameters,element);else if(theregex.test(message))message=jQuery.format(message.replace(theregex,"{$1}"),rule.parameters);this.errorList.push({message:message,element:element});this.errorMap[element.name]=message;this.submitted[element.name]=message},addWrapper:function(toToggle){if(this.settings.wrapper)toToggle=toToggle.add(toToggle.parent(this.settings.wrapper));return toToggle},defaultShowErrors:function(){for(var i=0;this.errorList[i];i++){var error=this.errorList[i];this.settings.highlight&&this.settings.highlight.call(this,error.element,this.settings.errorClass,this.settings.validClass);this.showLabel(error.element,error.message)}if(this.errorList.length)this.toShow=this.toShow.add(this.containers);if(this.settings.success)for(var i=0;this.successList[i];i++)this.showLabel(this.successList[i]);if(this.settings.unhighlight)for(var i=0,elements=this.validElements();elements[i];i++)this.settings.unhighlight.call(this,elements[i],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow);this.hideErrors();this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return $(this.errorList).map(function(){return this.element})},showLabel:function(element,message){var label=this.errorsFor(element);if(label.length){label.removeClass().addClass(this.settings.errorClass);label.attr("generated")&&label.html(message)}else{label=$("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(element),generated:true}).addClass(this.settings.errorClass).html(message||"");if(this.settings.wrapper)label=label.hide().show().wrap("<"+this.settings.wrapper+"/>").parent();if(!this.labelContainer.append(label).length)this.settings.errorPlacement?this.settings.errorPlacement(label,$(element)):label.insertAfter(element)}if(!message&&this.settings.success){label.text("");typeof this.settings.success=="string"?label.addClass(this.settings.success):this.settings.success(label)}this.toShow=this.toShow.add(label)},errorsFor:function(element){var name=this.idOrName(element);return this.errors().filter(function(){return $(this).attr("for")==name})},idOrName:function(element){return this.groups[element.name]||(this.checkable(element)?element.name:element.id||element.name)},checkable:function(element){return/radio|checkbox/i.test(element.type)},findByName:function(name){var form=this.currentForm;return $(document.getElementsByName(name)).map(function(index,element){return element.form==form&&element.name==name&&element||null})},getLength:function(value,element){switch(element.nodeName.toLowerCase()){case"select":return $("option:selected",element).length;case"input":if(this.checkable(element))return this.findByName(element.name).filter(":checked").length}return value.length},depend:function(param,element){return this.dependTypes[typeof param]?this.dependTypes[typeof param](param,element):true},dependTypes:{"boolean":function(param){return param},string:function(param,element){return!!$(param,element.form).length},"function":function(param,element){return param(element)}},optional:function(element){return!$.validator.methods.required.call(this,$.trim(element.value),element)&&"dependency-mismatch"},startRequest:function(element){if(!this.pending[element.name]){this.pendingRequest++;this.pending[element.name]=true}},stopRequest:function(element,valid){this.pendingRequest--;if(this.pendingRequest<0)this.pendingRequest=0;delete this.pending[element.name];if(valid&&this.pendingRequest==0&&this.formSubmitted&&this.form()){$(this.currentForm).submit();this.formSubmitted=false}else if(!valid&&this.pendingRequest==0&&this.formSubmitted){$(this.currentForm).triggerHandler("invalid-form",[this]);this.formSubmitted=false}},previousValue:function(element){return $.data(element,"previousValue")||$.data(element,"previousValue",{old:null,valid:true,message:this.defaultMessage(element,"remote")})}},classRuleSettings:{required:{required:true},email:{email:true},specialword:{specialword:true},url:{url:true},date:{date:true},dateISO:{dateISO:true},dateDE:{dateDE:true},number:{number:true},numberDE:{numberDE:true},digits:{digits:true},specialchar:{specialchar:true},RecSpecialChar:{RecSpecialChar:true},creditcard:{creditcard:true}},addClassRules:function(className,rules){className.constructor==String?(this.classRuleSettings[className]=rules):$.extend(this.classRuleSettings,className)},classRules:function(element){var rules={},classes=$(element).attr("class");classes&&$.each(classes.split(" "),function(){this in $.validator.classRuleSettings&&$.extend(rules,$.validator.classRuleSettings[this])});return rules},attributeRules:function(element){var rules={},$element=$(element);for(var method in $.validator.methods){var value=$element.attr(method);if(value)rules[method]=value}if(rules.maxlength&&/-1|2147483647|524288/.test(rules.maxlength))delete rules.maxlength;return rules},metadataRules:function(element){if(!$.metadata)return{};var meta=$.data(element.form,"validator").settings.meta;return meta?$(element).metadata()[meta]:$(element).metadata()},staticRules:function(element){var rules={},validator=$.data(element.form,"validator");if(validator.settings.rules)rules=$.validator.normalizeRule(validator.settings.rules[element.name])||{};return rules},normalizeRules:function(rules,element){$.each(rules,function(prop,val){if(val===false){delete rules[prop];return}if(val.param||val.depends){var keepRule=true;switch(typeof val.depends){case"string":keepRule=!!$(val.depends,element.form).length;break;case"function":keepRule=val.depends.call(element,element)}if(keepRule)rules[prop]=val.param!==undefined?val.param:true;else delete rules[prop]}});$.each(rules,function(rule,parameter){rules[rule]=$.isFunction(parameter)?parameter(element):parameter});$.each(["minlength","maxlength","min","max"],function(){if(rules[this])rules[this]=Number(rules[this])});$.each(["rangelength","range"],function(){if(rules[this])rules[this]=[Number(rules[this][0]),Number(rules[this][1])]});if($.validator.autoCreateRanges){if(rules.min&&rules.max){rules.range=[rules.min,rules.max];delete rules.min;delete rules.max}if(rules.minlength&&rules.maxlength){rules.rangelength=[rules.minlength,rules.maxlength];delete rules.minlength;delete rules.maxlength}}if(rules.messages)delete rules.messages;return rules},normalizeRule:function(data){if(typeof data=="string"){var transformed={};$.each(data.split(/\s/),function(){transformed[this]=true});data=transformed}return data},addMethod:function(name,method,message){$.validator.methods[name]=method;$.validator.messages[name]=message!=undefined?message:$.validator.messages[name];method.length<3&&$.validator.addClassRules(name,$.validator.normalizeRule(name))},methods:{required:function(value,element,param){if(!this.depend(param,element))return"dependency-mismatch";switch(element.nodeName.toLowerCase()){case"select":var val=$(element).val();return val&&val.length>0;case"input":if(this.checkable(element))return this.getLength(value,element)>0;default:return $.fn.replaceChinesePlace($.trim(value)).length>0}},remote:function(value,element,param){if(this.optional(element))return"dependency-mismatch";var previous=this.previousValue(element);if(!this.settings.messages[element.name])this.settings.messages[element.name]={};previous.originalMessage=this.settings.messages[element.name].remote;this.settings.messages[element.name].remote=previous.message;param=typeof param=="string"&&{url:param}||param;if(this.pending[element.name])return"pending";if(previous.old===value)return previous.valid;previous.old=value;var validator=this;this.startRequest(element);var data={};data[element.name]=value;$.ajax($.extend(true,{url:param,mode:"abort",port:"validate"+element.name,dataType:"text json",data:data,success:function(response){validator.settings.messages[element.name].remote=previous.originalMessage;response=typeof response=="boolean"?response:response=="true"?true:false;var valid=response===true;if(valid){var submitted=validator.formSubmitted;validator.prepareElement(element);validator.formSubmitted=submitted;validator.successList.push(element);validator.showErrors()}else{var errors={},message=response||validator.defaultMessage(element,"remote");errors[element.name]=previous.message=$.isFunction(message)?message(value):message;validator.showErrors(errors)}previous.valid=valid;validator.stopRequest(element,valid)}},param));return"pending"},minlength:function(value,element,param){return this.optional(element)||this.getLength($.fn.replaceChinesePlace($.trim(value)),element)>=param},maxlength:function(value,element,param){return this.optional(element)||this.getLength($.fn.replaceChinesePlace($.trim(value)),element)<=param},rangelength:function(value,element,param){var length=this.getLength($.fn.replaceChinesePlace($.trim(value)),element);return this.optional(element)||length>=param[0]&&length<=param[1]},min:function(value,element,param){return this.optional(element)||value>=param},max:function(value,element,param){return this.optional(element)||value<=param},range:function(value,element,param){value=value.replace(/^\s*/,"");value=value.replace(/\s*$/,"");return this.optional(element)||value>=param[0]&&value<=param[1]},email:function(value,element){value=value.replace(/^\s*/,"");value=value.replace(/\s*$/,"");return this.optional(element)||/^([a-zA-Z0-9][_\.\-]*)+\@([A-Za-z0-9])+((\.|-|_)[A-Za-z0-9]+)*((\.[A-Za-z0-9]{2,4}){1,2})$/i.test(value)},specialword:function(value,element){return this.optional(element)||/^[^<>:*?"\/\\|]*$/.test(value)},url:function(value,element){return this.optional(element)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(value)},date:function(value,element){return this.optional(element)||!/Invalid|NaN/.test(new Date(value))},dateISO:function(value,element){return this.optional(element)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(value)},number:function(value,element){return this.optional(element)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(value)},digits:function(value,element){value=value.replace(/^\s*/,"");value=value.replace(/\s*$/,"");return this.optional(element)||/^\d+$/.test(value)},creditcard:function(value,element){if(this.optional(element))return"dependency-mismatch";if(/[^0-9-]+/.test(value))return false;var nCheck=0,nDigit=0,bEven=false;value=value.replace(/\D/g,"");for(var n=value.length-1;n>=0;n--){var cDigit=value.charAt(n),nDigit=parseInt(cDigit,10);if(bEven)if((nDigit*=2)>9)nDigit-=9;nCheck+=nDigit;bEven=!bEven}return nCheck%10==0},accept:function(value,element,param){param=typeof param=="string"?param.replace(/,/g,"|"):"png|jpe?g|gif";return this.optional(element)||value.match(new RegExp(".("+param+")$","i"))},specialchar:function(value,element){return this.optional(element)||/^[^-<>&^\\']*$/.test(value)},RecSpecialChar:function(value,element){return this.optional(element)||/^[^<>']*$/.test(value)},equalTo:function(value,element,param){var target=$(param).unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){$(element).valid()});return value==target.val()}}});$.format=$.validator.format})(jQuery);(function($){var pendingRequests={};if($.ajaxPrefilter)$.ajaxPrefilter(function(settings,_,xhr){var port=settings.port;if(settings.mode=="abort"){pendingRequests[port]&&pendingRequests[port].abort();pendingRequests[port]=xhr}});else{var ajax=$.ajax;$.ajax=function(settings){var mode=("mode"in settings?settings:$.ajaxSettings).mode,port=("port"in settings?settings:$.ajaxSettings).port;if(mode=="abort"){pendingRequests[port]&&pendingRequests[port].abort();return pendingRequests[port]=ajax.apply(this,arguments)}return ajax.apply(this,arguments)}}})(jQuery);(function($){!jQuery.event.special.focusin&&!jQuery.event.special.focusout&&document.addEventListener&&$.each({focus:"focusin",blur:"focusout"},function(original,fix){$.event.special[fix]={setup:function(){this.addEventListener(original,handler,true)},teardown:function(){this.removeEventListener(original,handler,true)},handler:function(e){arguments[0]=$.event.fix(e);arguments[0].type=fix;return $.event.handle.apply(this,arguments)}};function handler(e){e=$.event.fix(e);e.type=fix;return $.event.handle.call(this,e)}});$.extend($.fn,{validateDelegate:function(delegate,type,handler){return this.bind(type,function(event){var target=$(event.target);if(target.is(delegate))return handler.apply(target,arguments)})}})})(jQuery);(function(){function a(b){return b.replace(/<.[^<>]*?>/g," ").replace(/&nbsp;|&#160;/gi," ").replace(/[0-9.(),;:!?%#$'"_+=\/-]*/g,"")}jQuery.validator.addMethod("maxWords",function(c,b,d){return this.optional(b)||a(c).match(/\b\w+\b/g).length<d},jQuery.validator.format("Please enter {0} words or less."));jQuery.validator.addMethod("minWords",function(c,b,d){return this.optional(b)||a(c).match(/\b\w+\b/g).length>=d},jQuery.validator.format("Please enter at least {0} words."));jQuery.validator.addMethod("rangeWords",function(c,b,d){return this.optional(b)||a(c).match(/\b\w+\b/g).length>=d[0]&&c.match(/bw+b/g).length<d[1]},jQuery.validator.format("Please enter between {0} and {1} words."))})();jQuery.validator.addMethod("letterswithbasicpunc",function(b,a){return this.optional(a)||/^[a-z-.,()'\"\s]+$/i.test(b)},"Letters or punctuation only please");jQuery.validator.addMethod("alphanumeric",function(b,a){return this.optional(a)||/^\w+$/i.test(b)},"Letters, numbers, spaces or underscores only please");jQuery.validator.addMethod("istext",function(b,a){b=b.replace(/^\s*/,"");b=b.replace(/\s*$/,"");return this.optional(a)||/^[A-Za-z0-9]+$/i.test(b)},"Letters, numbers, spaces or underscores only please");jQuery.validator.addMethod("isCtext",function(b,a){return this.optional(a)||/^([A-Za-z0-9_\u4E00-\u9FA5])+$/i.test(b)},"Letters, numbers, spaces or underscores only please");jQuery.validator.addMethod("lettersonly",function(b,a){return this.optional(a)||/^[a-z]+$/i.test(b)},"Letters only please");jQuery.validator.addMethod("nowhitespace",function(b,a){return this.optional(a)||/^\S+$/i.test(b)},"No white space please");jQuery.validator.addMethod("ziprange",function(b,a){return this.optional(a)||/^90[2-5]\d\{2}-\d{4}$/.test(b)},"Your ZIP-code must be in the range 902xx-xxxx to 905-xx-xxxx");jQuery.validator.addMethod("integer",function(b,a){return this.optional(a)||/^-?\d+$/.test(b)},"A positive or negative non-decimal number please");jQuery.validator.addMethod("percent",function(b,a){return this.optional(a)||/^\d+(\.\d+)?$/.test($.fn.replaceChinesePlace(b))},"请输入正确的格式：10.5%");jQuery.validator.addMethod("vinUS",function(o){if(o.length!=17)return false;for(var a,l,j,b,k,c=["A","B","C","D","E","F","G","H","J","K","L","M","N","P","R","S","T","U","V","W","X","Y","Z"],m=[1,2,3,4,5,6,7,8,1,2,3,4,5,7,9,2,3,4,5,6,7,8,9],g=[8,7,6,5,4,3,2,10,0,9,8,7,6,5,4,3,2],e=0,h=0;h<17;h++){j=g[h];l=o.slice(h,h+1);if(h==8)k=l;if(!isNaN(l))l*=j;else for(a=0;a<c.length;a++)if(l.toUpperCase()===c[a]){l=m[a];l*=j;if(isNaN(k)&&a==8)k=c[a];break}e+=l}b=e%11;if(b==10)b="X";return b==k?true:false},"The specified vehicle identification number (VIN) is invalid.");jQuery.validator.addMethod("dateITA",function(e,c){var a=false,g=/^\d{1,2}\/\d{1,2}\/\d{4}$/;if(g.test(e)){var i=e.split("/"),d=parseInt(i[0],10),b=parseInt(i[1],10),f=parseInt(i[2],10),h=new Date(f,b-1,d);if(h.getFullYear()==f&&h.getMonth()==b-1&&h.getDate()==d)a=true;else a=false}else a=false;return this.optional(c)||a},"Please enter a correct date");jQuery.validator.addMethod("dateCN",function(d,b){var c=(new RegExp("^(?:(?:([0-9]{4}(-|/)(?:(?:0?[1,3-9]|1[0-2])(-|/)(?:29|30)|((?:0?[13578]|1[02])(-|/)31)))|([0-9]{4}(-|/)(?:0?[1-9]|1[0-2])(-|/)(?:0?[1-9]|1\\d|2[0-8]))|(((?:(\\d\\d(?:0[48]|[2468][048]|[13579][26]))|(?:0[48]00|[2468][048]00|[13579][26]00))(-|/)0?2(-|/)29))))$")).test($.fn.replaceChinesePlace(d)),a=(new RegExp(/^\d\d?[\.\/-]\d\d?[\.\/-]\d\d\d?\d?$/)).test($.fn.replaceChinesePlace(d));return this.optional(b)||(c||a)},"请输入正确的日期");jQuery.validator.addMethod("time",function(b,a){return this.optional(a)||/^(([01][0-9])|(2[0123])):([0-5])([0-9]):([0-5])([0-9])$/.test($.fn.replaceChinesePlace(b))},"请输入正确的时间格式：01:01:23");jQuery.validator.addMethod("phoneCN",function(a,b){var a=$.fn.replaceChinesePlace(a);return this.optional(b)||a.match(/^([\d\-()\+]{1,20})+$/g)},"请输入正确的电话号码如：0123-12345678");jQuery.validator.addMethod("mobileCN",function(a,b){var a=$.fn.replaceChinesePlace(a);return this.optional(b)||a.match(/^([\d\-()\+]{1,20})+$/g)},"请输入正确的手机号码如：13601234567");jQuery.validator.addMethod("TMphoneCN",function(a,b){var a=$.fn.replaceChinesePlace(a);return this.optional(b)||a.match(/^([\d\-()\+]{1,20})+$/g)},"请输入您的固定电话或移动手机号码");jQuery.validator.addMethod("strippedminlength",function(b,a,c){return jQuery(b).text().length>=c},jQuery.validator.format("Please enter at least {0} characters"));jQuery.validator.addMethod("email2",function(b,a){return this.optional(a)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)*(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(b)},jQuery.validator.messages.email);jQuery.validator.addMethod("url2",function(b,a){return this.optional(a)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)*(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(b)},jQuery.validator.messages.url);jQuery.validator.addMethod("creditcardtypes",function(b,a,c){if(/[^0-9-]+/.test(b))return false;b=b.replace(/\D/g,"");var d=0;if(c.mastercard)d|=1;if(c.visa)d|=2;if(c.amex)d|=4;if(c.dinersclub)d|=8;if(c.enroute)d|=16;if(c.discover)d|=32;if(c.jcb)d|=64;if(c.unknown)d|=128;if(c.all)d=1|2|4|8|16|32|64|128;return d&1&&/^(51|52|53|54|55)/.test(b)?b.length==16:d&2&&/^(4)/.test(b)?b.length==16:d&4&&/^(34|37)/.test(b)?b.length==15:d&8&&/^(300|301|302|303|304|305|36|38)/.test(b)?b.length==14:d&16&&/^(2014|2149)/.test(b)?b.length==15:d&32&&/^(6011)/.test(b)?b.length==16:d&64&&/^(3)/.test(b)?b.length==16:d&64&&/^(2131|1800)/.test(b)?b.length==15:d&128?true:false},"Please enter a valid credit card number.");jQuery.validator.addMethod("englishName",function(b,a){b=b.replace(/^\s*/,"");b=b.replace(/\s*$/,"");return this.optional(a)||/^([A-Za-z.-]+\s?)+$/i.test(b)},"请输入正确的英文名称");jQuery.validator.addMethod("noChinese",function(b,a){b=b.replace(/^\s*/,"");b=b.replace(/\s*$/,"");return this.optional(a)||/^[^\u4e00-\u9fa5]+$/i.test(b)},"编号不能为中文");jQuery.validator.addMethod("idNumber",function(b,a){b=b.replace(/^\s*/,"");b=b.replace(/\s*$/,"");return this.optional(a)||/^[1-9][0-7]\d{4}((19\d{2}(0[13-9]|1[012])(0[1-9]|[12]\d|30))|(19\d{2}(0[13578]|1[02])31)|(19\d{2}02(0[1-9]|1\d|2[0-8]))|(19([13579][26]|[2468][048]|0[48])0229))\d{3}(\d|X|x)?$/i.test(b)},"身份证号格式不正确");jQuery.validator.addMethod("zipCode",function(b,a){b=b.replace(/^\s*/,"");b=b.replace(/\s*$/,"");return this.optional(a)||/^[0-9]{6}$/i.test(b)},"邮政编码格式不正确");jQuery.validator.addMethod("dateTime",function(b,a){b=b.replace(/^\s*/,"");b=b.replace(/\s*$/,"");return this.optional(a)||/^((((1[6-9]|[2-9]\d)\d{2})([\.|-])(0?[13578]|1[02])([[\.|-])(0?[1-9]|[12]\d|3[01]))|(((1[6-9]|[2-9]\d)\d{2})([\.|-])(0?[13456789]|1[012])([[\.|-])(0?[1-9]|[12]\d|30))|(((1[6-9]|[2-9]\d)\d{2})([[\.|-])0?2([[\.|-])(0?[1-9]|1\d|2[0-9]))|(((1[6-9]|[2-9]\d)(0[48]|[2468][048]|[13579][26])|((16|[2468][048]|[3579][26])00))([[\.|-])0?2([\.])29([[\.|-])))$/i.test(b)},"日期格式有误如：2010.06.01或2010-06-01");(function($){$.extend({progressBar:new function(){this.defaults={steps:20,stepDuration:20,max:100,showText:true,textFormat:"percentage",width:120,height:12,callback:null,boxImage:"http://stnew.beisen.com/2016.09.09.003/common/skin/bluelight/images/progressbar/progressbar.gif",barImage:{0:"http://stnew.beisen.com/2016.09.09.003/common/skin/bluelight/images/progressbar/progressbg_red.gif",21:"http://stnew.beisen.com/2016.09.09.003/common/skin/bluelight/images/progressbar/progressbg_orange.gif",61:"http://stnew.beisen.com/2016.09.09.003/common/skin/bluelight/images/progressbar/progressbg_green.gif"},running_value:0,value:0,image:null,baseline:false,decimal:false,scores:null};this.construct=function(arg1,arg2){var argvalue=null,argconfig=null;if(arg1!=null)if(!isNaN(arg1)){argvalue=arg1;if(arg2!=null)argconfig=arg2}else argconfig=arg1;return this.each(function(){var pb=this,config=this.config;if(argvalue!=null&&this.bar!=null&&this.config!=null){this.config.value=this.config.decimal?argvalue:parseInt(argvalue);var tempDecimal=argvalue;if(argconfig!=null)pb.config=$.extend(this.config,argconfig);config=pb.config}else{var $this=$(this),config=$.extend({},$.progressBar.defaults,argconfig);config.id=$this.attr("id")?$this.attr("id"):Math.ceil(Math.random()*1e5);if(argvalue==null)argvalue=$this.html().replace("%","");config.value=parseInt(argvalue);var tempDecimal=argvalue;config.running_value=0;if(config.baseline){n=config.scores*10;eval("config.barImage = {0:\t'http://stnew.beisen.com/2016.09.09.003/common/skin/bluelight/images/progressbar/progressbg_red.gif',"+n+": 'http://stnew.beisen.com/2016.09.09.003/common/skin/bluelight/images/progressbar/progressbg_green.gif'}")}config.image=getBarImage(config);for(var numeric=["steps","stepDuration","max","width","height","running_value","value"],i=0;i<numeric.length;i++)config[numeric[i]]=parseInt(config[numeric[i]]);$this.html("");var bar=document.createElement("img"),text=document.createElement("span"),$bar=$(bar),$text=$(text);pb.bar=$bar;$bar.attr("id",config.id+"_pbImage");$text.attr("id",config.id+"_pbText");$text.html(getText(config));$bar.attr("title",tempDecimal+"%");$bar.attr("alt",getText(config));$bar.attr("src",config.boxImage);$bar.attr("width",config.width);$bar.css("width",config.width+"px");$bar.css("height",config.height+"px");$bar.css("background-image","url("+config.image+")");$bar.css("background-position",config.width*-1+"px 50%");$bar.css("padding","0");$bar.css("margin","0");$this.append($bar);$this.append($text);if(config.baseline){w=Math.round(config.scores*(config.width/5));$this.css({position:"relative",overflow:"hidden"});$this.prepend("<span class='linespan' style='width:"+w+"px;'>&nbsp;</span>")}}function getPercentage(config){return config.running_value*100/config.max}function getBarImage(config){var image=config.barImage;if(typeof config.barImage=="object")for(var i in config.barImage)if(config.running_value>=parseInt(i))image=config.barImage[i];else break;return image}function getText(config){if(config.showText)if(config.textFormat=="percentage")return" "+config.running_value+"%";else if(config.textFormat=="fraction")return" "+config.running_value+"/"+config.max;else if(config.textFormat=="scale")return" "+config.running_value/10}config.increment=Math.round((config.value-config.running_value)/config.steps);if(config.increment<0)config.increment*=-1;if(config.increment<1)config.increment=1;var t=setInterval(function(){var pixels=config.width/100;if(config.running_value>config.value)if(config.running_value-config.increment<config.value)config.running_value=config.value;else config.running_value-=config.increment;else if(config.running_value<config.value)if(config.running_value+config.increment>config.value)config.running_value=config.value;else config.running_value+=config.increment;var $bar=$("#"+config.id+"_pbImage"),$text=$("#"+config.id+"_pbText"),image=getBarImage(config);if(image!=config.image){$bar.css("background-image","url("+image+")");config.image=image}$bar.css("background-position",config.width*-1+getPercentage(config)*pixels+"px 50%");$bar.attr("title",tempDecimal+"%");$text.html(getText(config));if(config.running_value==config.value){$text.html(tempDecimal+"%");clearInterval(t)}config.callback!=null&&typeof config.callback=="function"&&config.callback(config);pb.config=config},config.stepDuration)})}}});$.fn.extend({progressBar:$.progressBar.construct})})(jQuery)
